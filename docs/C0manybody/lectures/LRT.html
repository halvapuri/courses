<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Linear Response Theory &amp; Electric Susceptibility – Worldlines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-343313b17078e6c2acf5a6c8a244e039.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1299936a809ae67bc7a7e26fb973ba17.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
function toggleBox(header) {
  // Use jQuery to find the associated container and toggle its visibility
  $(header).next('.dd-box').slideToggle();
  $(header).next('.ddm-box').slideToggle();
}
</script>

<script>
function togglePill(header) {
  const box = header.nextElementSibling;

  // toggle active pill state
  header.classList.toggle("active");

  // toggle content
  if (box.style.display === "block") {
    box.style.display = "none";
  } else {
    box.style.display = "block";
  }
}
</script>


<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".pill").forEach(pill => {
    const title = pill.getAttribute("title") || "";
    const bodyHtml = pill.innerHTML;

    // header
    const header = document.createElement("div");
    header.className = "pill-header";
    header.textContent = title;

    // body
    const body = document.createElement("div");
    body.className = "pill-body";
    body.innerHTML = bodyHtml;

    // reset pill
    pill.innerHTML = "";
    pill.appendChild(header);
    pill.appendChild(body);

    // toggle
    header.addEventListener("click", () => {
      header.classList.toggle("active");

      if (body.style.display === "block") {
        body.style.display = "none";
        pill.style.flexBasis = "auto";   // collapse back
      } else {
        body.style.display = "block";
        pill.style.flexBasis = "100%";   // expand pill to full row
      }
    });
  });
});
</script>


<script>
/**
 * Global registry and updater for all LeaderLine instances created via drawLeader.
 * Handles:
 *  - storing all lines
 *  - repositioning all lines on resize/scroll
 *  - smooth real-time repositioning during .pill transitions
 */
const LeaderLineRegistry = {
  lines: [],
  animating: false,
  _initialized: false,

  /**
   * Initialize one-time global event listeners for updating all registered lines.
   * This runs only once, automatically when the first line is registered.
   */
  init() {
    if (this._initialized) return;
    this._initialized = true;

    // Reposition all lines on window resize
    window.addEventListener('resize', () => this.positionAll());

    // Reposition all lines on scroll (capturing to catch scrolls on inner containers too)
    document.addEventListener('scroll', () => this.positionAll(), true);

    // Automatically add smooth animation loop for .pill transitions
    const pills = document.querySelectorAll('.pill');
    pills.forEach(pill => {
      pill.addEventListener('click', () => {
        if (this.animating) return;
        this.animating = true;

        const step = () => {
          this.positionAll();
          if (this.animating) requestAnimationFrame(step);
        };
        requestAnimationFrame(step);
      });

      pill.addEventListener('transitionend', () => {
        this.animating = false;
        this.positionAll();
      });
    });
  },

  /**
   * Register a newly created LeaderLine instance so it is tracked and updated.
   * @param {LeaderLine} line - The LeaderLine object to register
   */
  register(line) {
    this.init();
    this.lines.push(line);
  },

  /**
   * Calls .position() on every registered line to recalculate its endpoints.
   */
  positionAll() {
    this.lines.forEach(line => line.position());
  }
};

/**
 * Creates two DOM anchor elements (if not already present) inside a container
 * and draws a LeaderLine between them. Automatically registers the line
 * into the global LeaderLineRegistry so it stays in sync with layout changes.
 *
 * @param {Object} config
 * @param {string} [config.containerId='stage'] - The id of the container element
 * @param {Object} config.from - The "from" anchor element config
 * @param {string} config.from.id - DOM id of the starting element
 * @param {string} [config.from.text] - Optional text content for the element
 * @param {string} [config.from.className] - Optional CSS class
 * @param {Object} [config.from.style] - Inline style object
 * @param {Object} config.to - The "to" anchor element config (same fields as 'from')
 * @param {Object} [config.lineOptions={}] - Options passed directly to new LeaderLine()
 *
 * @returns {Promise<LeaderLine>} Resolves with the created LeaderLine instance
 */
function drawLeader(config) {
  const { containerId='stage', from, to, lineOptions={} } = config;

  return new Promise(resolve => {
    window.addEventListener('load', () => {
      const container = document.getElementById(containerId);
      const elements = { from, to };
      const createdDivs = {};

      for (const key in elements) {
        const { id, text, className, style } = elements[key];
        let el = document.getElementById(id);

        if (!el || !container.contains(el)) {
          el = document.createElement('div');
          el.id = id;
          el.textContent = text || '';
          el.className = className || 'anchor80-line';
          Object.assign(el.style, { position: 'relative', ...style });
          container.appendChild(el);
        }

        createdDivs[key] = el;
      }

      const line = new LeaderLine(createdDivs.from, createdDivs.to, lineOptions);
      LeaderLineRegistry.register(line);
      resolve(line);
    });
  });
}

</script>






  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../css/buttons.css">
<link rel="stylesheet" href="../../css/tabs.css">
<link rel="stylesheet" href="../../css/callouts.css">
<link rel="stylesheet" href="../../css/fonts-ebgaramond.css">
<link rel="stylesheet" href="../../css/fonts-hand.css">
<link rel="stylesheet" href="../../css/shapes.css">
<link rel="stylesheet" href="../../css/leaders.css">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Worldlines</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="../../C0calculusI/home_calculusI.html">
 <span class="dropdown-text">Calculus I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../C0calculusII/home_calculusII.html">
 <span class="dropdown-text">Calculus II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../C0ode/home_ode.html">
 <span class="dropdown-text">Diff. Eqs. &amp; Lin. Alg.</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../C0noneqthermo/home_noneqthermo.html">
 <span class="dropdown-text">Non-equilibrium Thermodynamics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-guides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Guides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-guides">    
        <li>
    <a class="dropdown-item" href="../../D0abinit/home_abinit.html">
 <span class="dropdown-text">Ab initio calculation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../C0manybody/lectures/currentdensityoperator.html">Topics</a></li><li class="breadcrumb-item"><a href="../../C0manybody/lectures/LRT.html">Linear Response Theory &amp; Electric Susceptibility</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../_figs/hugorheinholdchimp.png" alt="Undergraduate ponders mysteries of physics, mathematics, and life" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/home_manybody.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many-Body Physics Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/currentdensityoperator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Current Density Operator and Polarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/exchangecorrelation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exchange &amp; Correlation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/excitons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Excitons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/greensfunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Green’s Functions in Many-Body Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/homogeneouselectrongas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HEG/jellium</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kohnsham.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kohn Sham Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kramerskronig.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyticity, Causality, and Kramers-Kronig Relations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kubofigure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kubofigure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kuboformula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kubo formula and response functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/LRT.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Linear Response Theory &amp; Electric Susceptibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/LRT-electric_susceptiblity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Electric Susceptibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/phonons_optic_acoustic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acoustic vs Optical Phonons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/quasiparticles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quasiparticles and Fermi Liquid Theory</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background-kubos-formula" id="toc-background-kubos-formula" class="nav-link active" data-scroll-target="#background-kubos-formula">Background: Kubo’s Formula</a></li>
  <li><a href="#from-kubos-formula-to-susceptibility" id="toc-from-kubos-formula-to-susceptibility" class="nav-link" data-scroll-target="#from-kubos-formula-to-susceptibility">From Kubo’s Formula to Susceptibility</a></li>
  <li><a href="#fourier-transform-conventions" id="toc-fourier-transform-conventions" class="nav-link" data-scroll-target="#fourier-transform-conventions">Fourier Transform Conventions</a></li>
  <li><a href="#now-to-find-susceptibility-chimathbfk-omega" id="toc-now-to-find-susceptibility-chimathbfk-omega" class="nav-link" data-scroll-target="#now-to-find-susceptibility-chimathbfk-omega">Now to find susceptibility <span class="math inline">\chi(\mathbf{k}, \omega)</span></a></li>
  <li><a href="#remarks-interpretation" id="toc-remarks-interpretation" class="nav-link" data-scroll-target="#remarks-interpretation">Remarks / interpretation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../C0manybody/lectures/currentdensityoperator.html">Topics</a></li><li class="breadcrumb-item"><a href="../../C0manybody/lectures/LRT.html">Linear Response Theory &amp; Electric Susceptibility</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Linear Response Theory &amp; Electric Susceptibility</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="background-kubos-formula" class="level2">
<h2 class="anchored" data-anchor-id="background-kubos-formula">Background: Kubo’s Formula</h2>
<p>Since we are going to apply time-dependent perturbations in the linear response regime, we need to remind ourselves, how the values of an observable vary when the perturbation comes into play. That is to say we need to remind ourselves of:</p>
<div class="pillset">
<div class="pill" title="The Kubo Formula">
<p><a href="https://en.wikipedia.org/wiki/Kubo_formula">Derivation of Kubo formula</a></p>
<p><span class="math display">
{\displaystyle \langle {\hat {A}}(t)\rangle =\left\langle {\hat {A}}\right\rangle _{0}-{\frac {i}{\hbar }}\int _{t_{0}}^{t}dt'\left\langle \left[{\hat {A}}(t),{\hat {V}}{\mathord {\left(t'\right)}}\right]\right\rangle _{0}}
</span></p>
<p>And thus in linear response theory, the change in expectation value of an operator <span class="math inline">\hat A</span> is <span id="eq-kubo"><span class="math display">
\delta\langle \hat A(t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^t dt' \,
\langle [\hat H_I(t'), \hat A(t)] \rangle_0 ,
\tag{1}</span></span></p>
<p>with <span class="math inline">\hat H_I(t')</span> the interaction Hamiltonian.</p>
</div>
<div class="pill" title="...apply it to polarization and E-field">
<p>In our case we have a perturbation due to the interaction between electric polarization and the time dependent electric field.</p>
<p><span id="eq-hamiltonian"><span class="math display">
\hat H(t) = H_0 - \int d\mathbf r'\,\hat{\mathbf P}(\mathbf r') \cdot \mathbf E(\mathbf r',t),
\tag{2}</span></span></p>
<p>where <span class="math inline">\hat{\mathbf P}(\mathbf r)</span> is the polarization operator.</p>
<p>For <span class="math inline">\hat A(t) = \hat P_i(\mathbf r,t)</span>,<span class="math inline">\ </span> <a href="#eq-kubo" class="quarto-xref">Equation&nbsp;1</a> becomes: <span class="math display">
\delta \langle \hat P_i(\mathbf r,t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^t dt' \int d\mathbf r' \,
\Big\langle \big[ -\hat P_j(\mathbf r',t') E_j(\mathbf r',t'), \,
\hat P_i(\mathbf r,t) \big] \Big\rangle_0 .
</span></p>
<p>Since <span class="math inline">E_j(\mathbf r',t')</span> is a classical field (a c-number, not an operator), it commutes with operators and can be pulled out: <span class="math display">
= -\frac{i}{\hbar}\int_{-\infty}^t dt' \int d\mathbf r' \,
E_j(\mathbf r',t') \, \langle [\hat P_j(\mathbf r',t'), \hat P_i(\mathbf r,t)] \rangle_0 .
</span></p>
<p>Using <span class="math inline">[X,Y] = -[Y,X]</span>, this becomes <span class="math display">
\delta \langle \hat P_i(\mathbf r,t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^t dt' \int d\mathbf r' \,
\langle [\hat P_i(\mathbf r,t), \hat P_j(\mathbf r',t')] \rangle_0 \,
E_j(\mathbf r',t') .
</span></p>
</div>
<div class="pill" title="to bring in retarded susceptibility as a Green's function">
<p>We can now introduce the retarded susceptibility (response function): <span class="math display">
\chi_{ij}^R(\mathbf r,t;\mathbf r',t')
= \frac{i}{\hbar} \, \Theta(t-t') \,
\langle [\hat P_i(\mathbf r,t), \hat P_j(\mathbf r',t')] \rangle_0 .
</span></p>
<p>Then the response takes the compact Green’s-function form: <span class="math display">
\delta \langle \hat P_i(\mathbf r,t)\rangle
= \int d\mathbf r' \int_{-\infty}^\infty dt' \,
\chi_{ij}^R(\mathbf r,t;\mathbf r',t') \, E_j(\mathbf r',t').
</span></p>
</div>
</div>
</section>
<section id="from-kubos-formula-to-susceptibility" class="level2">
<h2 class="anchored" data-anchor-id="from-kubos-formula-to-susceptibility">From Kubo’s Formula to Susceptibility</h2>
<p>We start from the general constitutive relation between the polarization <span class="math inline">P</span> and the electric field <span class="math inline">E</span> in a linear medium:</p>
<p><span id="eq-polarization_t"><span class="math display">
P_i(\mathbf{r},t)
= \varepsilon_0 \int d^3r' \int_{-\infty}^{\infty} dt'\;
\chi(\mathbf{r}, t; \mathbf{r}',t') \, E(\mathbf{r}',t').
\tag{3}</span></span></p>
<p>This Green’s function relation emerges out of the Kubo formula. Below we make two changes to it: (1) We use the component notation with the summation convention in place, and (2) We impose the constraint that time dependence is stationary (i.e.&nbsp;is a function of <span class="math inline">t-t'</span>) and the space dependence exhibits translational invariance or homongeneity (is a function of <span class="math inline">\mathbf{r}-\mathbf{r'}</span>):</p>
<p><span class="math display">
P_i(\mathbf{r},t)
= \varepsilon_0 \int d^3r' \int_{-\infty}^{\infty} dt'\;
\chi_{ij}(\mathbf{r}-\mathbf{r}',\,t-t') \, E_j(\mathbf{r}',t').
</span></p>
<p>So we have gone from the Kubo formula, to a <strong>space-time convolution</strong> because the susceptibility depends only on the differences <span class="math inline">\mathbf{r}-\mathbf{r}'</span> and <span class="math inline">t-t'</span>. The Fourier transform is going to turn it into a multiplication:</p>
<p><span class="math display">
\boxed{\tilde{P}_i(\mathbf{k},\omega)=\varepsilon_0\,\tilde\chi_{ij}(\mathbf{k},\omega)\,\tilde{E}_j(\mathbf{k},\omega)}.
</span></p>
</section>

<div class="no-row-height column-margin column-container"><section id="fourier-transform-conventions" class="level2">
<h2 class="anchored" data-anchor-id="fourier-transform-conventions">Fourier Transform Conventions</h2>
<p>We define the Fourier transform as</p>
<p><span class="math display">
f(\mathbf{r},t)
= \int \frac{d^3k}{(2\pi)^3} \int \frac{d\omega}{2\pi}
\; \tilde{f}(\mathbf{k},\omega)
e^{i(\mathbf{k}\cdot\mathbf{r}-\omega t)},
</span></p>
<p>with the inverse transform</p>
<p><span class="math display">
\tilde{f}(\mathbf{k},\omega)
= \int d^3r \int dt\; f(\mathbf{r},t) e^{-i(\mathbf{k}\cdot\mathbf{r}-\omega t)}.
</span></p>
</section></div><div class="pill" title="Convolution becometh Multiplication">
<p>The Fourier transform <span class="math inline">P_i(\mathbf{r},t)</span>:</p>
<p><span class="math display">
\tilde{P}_i(\mathbf{k},\omega)
= \int d^3r \int dt\; e^{-i(\mathbf{k}\cdot\mathbf{r}-\omega t)} P_i(\mathbf{r},t).
</span></p>
<p>Inserting the constitutive relation gives</p>
<p><span class="math display">
\tilde{P}_i(\mathbf{k},\omega)
= \varepsilon_0 \int d^3r \int dt\;
e^{-i(\mathbf{k}\cdot\mathbf{r}-\omega t)}
\int d^3r' dt' \,
\chi_{ij}(\mathbf{r}-\mathbf{r}',t-t') E_j(\mathbf{r}',t').
</span></p>
<p>Let <span class="math inline">\mathbf{R}=\mathbf{r}-\mathbf{r}'</span> and <span class="math inline">\tau=t-t'</span>, so <span class="math inline">\mathbf{r}=\mathbf{R}+\mathbf{r}'</span> and <span class="math inline">t=\tau+t'</span>. Then</p>
<p><span class="math display">
\tilde{P}_i(\mathbf{k},\omega)
= \varepsilon_0 \int d^3R d\tau \int d^3r' dt'\;
e^{-i[\mathbf{k}\cdot(\mathbf{R}+\mathbf{r}') -\omega (\tau+t')]}
\chi_{ij}(\mathbf{R},\tau) E_j(\mathbf{r}',t').
</span></p>
<p>The exponential factor splits into two parts:</p>
<p><span class="math display">
e^{-i(\mathbf{k}\cdot\mathbf{R}-\omega \tau)}\,
e^{-i(\mathbf{k}\cdot\mathbf{r}'-\omega t')}.
</span></p>
<p>The integrals factor, giving</p>
<p><span class="math display">
\tilde{P}_i(\mathbf{k},\omega)
= \varepsilon_0
\underbrace{\int d^3R d\tau\;\chi_{ij}(\mathbf{R},\tau) e^{-i(\mathbf{k}\cdot\mathbf{R}-\omega\tau)}}_{\tilde\chi_{ij}(\mathbf{k},\omega)}
\underbrace{\int d^3r' dt'\; E_j(\mathbf{r}',t') e^{-i(\mathbf{k}\cdot\mathbf{r}'-\omega t')}}_{\tilde{E}_j(\mathbf{k},\omega)}.
</span></p>
<p>So we obtain the diagonal relation:</p>
<p><span class="math display">
\boxed{\tilde{P}_i(\mathbf{k},\omega)=\varepsilon_0\,\tilde\chi_{ij}(\mathbf{k},\omega)\,\tilde{E}_j(\mathbf{k},\omega)}.
</span></p>
<p>In doing so we have taken the following path: <span class="math display">
\chi(\mathbf{r}, t; \mathbf{r'}, t') \rightarrow \chi(\mathbf{r} - \mathbf{r'}, t-t')\rightarrow \chi(s, \tau)\rightarrow \chi(\mathbf{k}, \omega)
</span></p>
</div>
<div class="pill" title="but if you're still not convinced...">
<p>There is another way of seeing how <span class="math inline">\chi</span> goes over to the Fourier domain. We transform ALL the variables independently:</p>
<p><span class="math display">
\chi(\mathbf{r}, t; \mathbf{r'}, t') \rightarrow \chi(\mathbf{k}, \mathbf{k'}, \mathbf{\omega}, \mathbf{\omega'})
</span></p>
<p>But the imposition of the stationarity and homogeneity conditions introduces delta functions:</p>
<p><span class="math display">
\chi(\mathbf{r} - \mathbf{r'}, t-t') \rightarrow \chi(\mathbf{k}, \mathbf{k'}, \mathbf{\omega}, \mathbf{\omega'}) \delta(\mathbf{k}- \mathbf{k'})\delta(\mathbf{\omega}- \mathbf{\omega'})
</span></p>
<p>To see this we start with the most general case (before assuming translational invariance). <span class="math inline">\chi</span> depends on two points and two times:</p>
<p><span class="math display">
\chi_{ij}(\mathbf{r},\mathbf{r}',t,t').
</span></p>
<p>We could Fourier transform it using two independent sets of variables:</p>
<p><span class="math display">
\chi_{ij}(\mathbf{r},\mathbf{r}',t,t')
= \int \frac{d^3k\,d^3k'}{(2\pi)^6}
\frac{d\omega\,d\omega'}{(2\pi)^2}\;
\tilde\chi_{ij}(\mathbf{k},\mathbf{k}',\omega,\omega')
e^{i(\mathbf{k}\cdot\mathbf{r}-\omega t)}e^{-i(\mathbf{k}'\cdot\mathbf{r}'-\omega' t')}.
</span></p>
<p>But if the medium is <strong>homogeneous in space</strong> and <strong>stationary in time</strong>, then</p>
<p><span class="math display">
\chi_{ij}(\mathbf{r},\mathbf{r}',t,t')
= \chi_{ij}(\mathbf{r}-\mathbf{r}',t-t').
</span></p>
<p>Letting <span class="math inline">\mathbf{R}=\mathbf{r}-\mathbf{r}'</span> and <span class="math inline">\tau=t-t'</span>, we have</p>
<p><span class="math display">
\tilde\chi_{ij}(\mathbf{k},\mathbf{k}',\omega,\omega')
=\int d^3r\, d^3r'\, dt\, dt' \;
\chi_{ij}(\mathbf{r}-\mathbf{r}',t-t')
e^{-i(\mathbf{k}\cdot\mathbf{r}-\omega t)}
e^{i(\mathbf{k}'\cdot\mathbf{r}'-\omega' t')}.
</span></p>
<p>Changing variables to <span class="math inline">(\mathbf{R},\mathbf{r}',\tau,t')</span> gives</p>
<p><span class="math display">
\int d^3R\, d^3r'\, d\tau\, dt' \;
\chi_{ij}(\mathbf{R},\tau)
e^{-i(\mathbf{k}\cdot\mathbf{R}-\omega\tau)}
e^{-i(\mathbf{k}-\mathbf{k}')\cdot\mathbf{r}'}
e^{i(\omega-\omega')t'}.
</span></p>
<p>Now do the <span class="math inline">\mathbf{r}'</span> and <span class="math inline">t'</span> integrals:</p>
<p><span class="math display">
\int d^3r'\; e^{-i(\mathbf{k}-\mathbf{k}')\cdot\mathbf{r}'}
=(2\pi)^3\delta(\mathbf{k}-\mathbf{k}')
</span></p>
<p><span class="math display">
\int dt'\; e^{i(\omega-\omega')t'}
=2\pi\delta(\omega-\omega').
</span></p>
<p>So we find</p>
<p><span class="math display">
\boxed{\tilde\chi_{ij}(\mathbf{k},\mathbf{k}',\omega,\omega')
=(2\pi)^4 \delta(\mathbf{k}-\mathbf{k}')\delta(\omega-\omega')\,
\chi_{ij}(\mathbf{k},\omega)}.
</span></p>
<p>Physically</p>
<ul>
<li>The delta functions are a <strong>direct mathematical consequence</strong> of space and time translational invariance.</li>
<li>They enforce <strong>momentum and energy conservation</strong>: a plane wave at <span class="math inline">(\mathbf{k},\omega)</span> can only drive a polarization at the <em>same</em> <span class="math inline">(\mathbf{k},\omega)</span>.</li>
<li>This is why the constitutive relation becomes <strong>diagonal</strong> in Fourier space:</li>
</ul>
<p>So we know that <a href="#eq-polarization_t" class="quarto-xref">Equation&nbsp;3</a> would become the product of Fourier transformed versions of <span class="math inline">\chi</span> and <span class="math inline">\mathbf{E}</span>. We can then substitute them from above to find once again: <span class="math display">
P_i(\mathbf{k},\omega)=\varepsilon_0\,\chi_{ij}(\mathbf{k},\omega)\,E_j(\mathbf{k},\omega).
</span></p>
</div>
<section id="now-to-find-susceptibility-chimathbfk-omega" class="level2">
<h2 class="anchored" data-anchor-id="now-to-find-susceptibility-chimathbfk-omega">Now to find susceptibility <span class="math inline">\chi(\mathbf{k}, \omega)</span></h2>
<p>We now want to find an expression for components of <span class="math inline">\chi(\mathbf{k}, \omega)</span>. If we follow Kubo linear-response formula step by step we will see that resonance terms (with denominators <span class="math inline">\hbar\omega_{\ell\ell'}\mp\hbar\omega\mp i\gamma</span>) appear.</p>
<p>So now the task is to:</p>
<ol type="1">
<li>Find <span class="math inline">\chi(s, \tau)</span></li>
</ol>
</section>
<div class="pill" title="...which we do here to find">
<section id="step-1-kubo-formula-for-the-polarization-response" class="level2">
<h2 class="anchored" data-anchor-id="step-1-kubo-formula-for-the-polarization-response">Step 1: Kubo formula for the polarization response</h2>
<p>Suppose the system is perturbed by a classical electric field that couples to the polarization by</p>
<p><span class="math display">
\color{green} H'(t) = -\int d^3r'\; P_j(\mathbf r')\,E_j(\mathbf r',t).
</span></p>
<p>To first order in the field, the induced expectation value of the polarization is (Kubo linear response)</p>
<p><span class="math display">
\delta\langle P_i(\mathbf r,t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^{t} dt'\, \big\langle \big[\color{green}H'(t')\color{black},\,P_i(\mathbf r,t)\big]\big\rangle_0,
</span></p>
<p>where <span class="math inline">\langle\cdots\rangle_0</span> is the expectation value in the unperturbed equilibrium state. Inserting <span class="math inline">H'(t')</span> and using linearity gives the response kernel</p>
<p><span class="math display">
\delta\langle P_i(\mathbf r,t)\rangle
= \int d^3r'\int_{-\infty}^t dt'\;
\chi_{ij}(\mathbf r-\mathbf r',t-t')\,E_j(\mathbf r',t'),
</span></p>
<p>with the susceptibility (Kubo form):</p>
<p><span class="math display">
\boxed{\;
\chi_{ij}(\mathbf s,\tau)
= \frac{i}{\hbar}\,\Theta(\tau)\,\langle\,[\,P_i(\mathbf r+\mathbf s,\;t+\tau),\;P_j(\mathbf r,t)\,]\,\rangle_0
\;}
</span></p>
<p>(here <span class="math inline">\mathbf s=\mathbf r-\mathbf r'</span>, <span class="math inline">\tau=t-t'</span>; because of homogeneity the kernel depends only on differences).</p>
<hr>
<p><span class="math display">
\newcommand{\green}[1]{\color{green}{#1}}
\newcommand{\red}[1]{\color{red}{#1}}
\newcommand{\gray}[1]{\color{gray}{#1}}
</span></p>
</section>
<section id="move-to-the-energy-eigenbasis-and-heisenberg-time-dependence" class="level2">
<h2 class="anchored" data-anchor-id="move-to-the-energy-eigenbasis-and-heisenberg-time-dependence">2) Move to the energy eigenbasis and Heisenberg time dependence</h2>
<p>Let <span class="math inline">\{|\ell\rangle\}</span> be eigenstates of the unperturbed Hamiltonian <span class="math inline">H</span> with energies <span class="math inline">E_\ell</span>. In the Heisenberg picture</p>
<p><span class="math display">
P_i(\mathbf r,t) = e^{\frac{i}{\hbar}Ht}\,P_i(\mathbf r)\,e^{-\frac{i}{\hbar}Ht}.
</span></p>
<p>Insert a complete set of eigenstates for the commutator and evaluate the expectation value as a thermal (or general diagonal) ensemble with probabilities <span class="math inline">w_\ell</span> (e.g.&nbsp;<span class="math inline">w_\ell=e^{-\beta E_\ell}/Z</span> for thermal equilibrium). Then</p>
<p><span class="math display">
\chi_{ij}(\mathbf s,\tau)
= \frac{i}{\hbar}\Theta(\tau)\sum_{\ell} w_\ell
\red{\sum_{m}}\Big(\langle\ell|P_i(\mathbf r+\mathbf s,t+\tau)\red{|m\rangle\langle m|}P_j(\mathbf r,t)|\ell\rangle \\
-
\langle\ell|P_j(\mathbf r,t)\red{|m\rangle\langle m|}P_i(\mathbf r+\mathbf s,t+\tau)|\ell\rangle\Big).
</span></p>
<p><span id="eq-suscep"><span class="math display">\begin{align*}
\chi_{ij}(\mathbf s,\tau)
=
\frac{i}{\hbar}\Theta(\tau)\sum_{\ell} w_\ell
\sum_{m}\Big(
  \color{#F4442E}\langle\ell|P_i(\mathbf r+\mathbf s,t+\tau)|m\rangle\color{black}
  \color{#188FA7}\langle m|P_j(\mathbf r,t)|\ell\rangle \color{black}\\
-
\langle\ell|P_j(\mathbf r,t)|m\rangle\langle m|P_i(\mathbf r+\mathbf s,t+\tau)|\ell\rangle\Big).
\end{align*}
\tag{4}</span></span></p>
<p>Where the colored bits can be reduced to their Schrodinger counterparts by using the Heisenberg time dependence:</p>
<p><span class="math display">\begin{align*}
\color{#F4442E}\langle\ell|P_i(\mathbf r+\mathbf s,t+\tau)|m\rangle\color{black}
&amp;= e^{i\color{green}\tfrac{(E_\ell-E_m)}{\hbar}\color{black}
(t+\tau)}\langle\ell|P_i(\mathbf r+\mathbf s)|m\rangle \\
&amp;=e^{i\color{green}\omega_{\ell m}\color{black}(t+\tau)}\langle\ell|P_i(\mathbf r+\mathbf s)|m\rangle,
\end{align*}
</span></p>
<p><span class="math display">\begin{align*}
\color{#188FA7}\langle m|P_j(\mathbf r,t)|\ell\rangle\color{black}
&amp;= e^{i\color{green}\tfrac{(E_\ell-E_m)}{\hbar}\color{black}t}\langle m|P_j(\mathbf r)|\ell\rangle\\
&amp;= e^{i\color{green}\omega_{\ell m}\color{black}(t)}\langle m|P_j(\mathbf r)|\ell\rangle
\end{align*}
</span></p>
<p>Where we have introduced the Bohr frequencies</p>
<p><span class="math display">
\omega_{m\ell}\equiv\frac{E_m-E_\ell}{\hbar} = -\omega_{\ell m}.
</span></p>
<p>Note how the overall <span class="math inline">t</span>-dependence cancels (as it must for a time-translation invariant equilibrium average), leaving <span class="math inline">\tau</span>-dependence through <span class="math inline">e^{\tfrac{i}{\hbar}(E_\ell-E_m)\tau}</span>.</p>
<p>So the commutator contribution becomes (for <span class="math inline">\tau&gt;0</span>)</p>
<p><span class="math display">\begin{align*}
\chi_{ij}(\mathbf s,\tau)
= \frac{i}{\hbar}\Theta(\tau)\sum_{\ell,m} w_\ell\Big(
&amp;e^{i\omega_{\ell m}\tau} \langle\ell|P_i(\mathbf r+\mathbf s)|m\rangle\langle m|P_j(\mathbf r)|\ell\rangle\\
- &amp;e^{i\omega_{m\ell}\tau}\langle\ell|P_j(\mathbf r)|m\rangle\langle m|P_i(\mathbf r+\mathbf s)|\ell\rangle
\Big).
\end{align*}
</span></p>
</section>
</div>
<p><span id="eq-susceptibilityST"><span class="math display">\begin{align*}
\chi_{ij}(\mathbf s,\tau)
= \frac{i}{\hbar}\Theta(\tau)\sum_{\ell,m} w_\ell\Big(
&amp;e^{i\omega_{\ell m}\tau} \langle\ell|P_i(\mathbf r+\mathbf s)|m\rangle\langle m|P_j(\mathbf r)|\ell\rangle\\
- &amp;e^{i\omega_{m\ell}\tau}\langle\ell|P_j(\mathbf r)|m\rangle\langle m|P_i(\mathbf r+\mathbf s)|\ell\rangle
\Big).
\end{align*}
\tag{5}</span></span></p>
<ol start="2" type="1">
<li>Convert it to <span class="math inline">\chi(\mathbf{k}, \omega)</span> using the recipes above.</li>
</ol>
<div class="pill" title="...which we do here and find">
<p>Now form the space–time Fourier transform used in the text (including the adiabatic factor <span class="math inline">e^{-\gamma\tau}</span>, <span class="math inline">\gamma\to0^+</span>, to ensure convergence):</p>
<p><span class="math display">
\chi_{ij}(\mathbf k,\omega)
= \lim_{\gamma\to0^+}\int d^3s\int_0^\infty d\tau\;
\chi_{ij}(\mathbf s,\tau)\,e^{-i\mathbf k\cdot\mathbf s + i\omega \tau -\gamma\tau}.
</span></p>
<p>Insert the expression for <span class="math inline">\chi_{ij}(\mathbf s,\tau)</span>. Define the spatial Fourier components of the polarization operator</p>
<p><span class="math display">
P_{i,\mathbf k} \equiv V^{-1/2}\int d^3r\;P_i(\mathbf r)\,e^{-i\mathbf k\cdot\mathbf r},
</span></p>
<p>so that matrix elements of the spatially shifted operator pick up factors <span class="math inline">e^{\pm i\mathbf k\cdot\mathbf s}</span>. After doing the <span class="math inline">\mathbf s</span>-integral one obtains matrix elements of the Fourier components <span class="math inline">P_{i,\mathbf k}</span> and <span class="math inline">P_{j,-\mathbf k}</span> (this is the reason the final expression involves <span class="math inline">P_{i,\mathbf k}</span> and <span class="math inline">P_{j,-\mathbf k}</span>).</p>
<p>Carrying out the <span class="math inline">\tau</span>-integral for a generic exponential factor:</p>
<p><span class="math display">
\int_0^\infty d\tau\; e^{i\omega_{\ell m}\tau}\,e^{i\omega\tau}\,e^{-\gamma\tau}
= \int_0^\infty d\tau\; e^{i(\omega_{\ell m}+\omega)\tau-\gamma\tau}
= \frac{i}{\omega_{\ell m}+\omega + i\gamma}.
</span></p>
<p>Be careful with signs: if the integrand was <span class="math inline">e^{i\omega_{\ell m}\tau}\,e^{ - i\omega \tau}</span> then the denominator would be <span class="math inline">\omega_{\ell m}-\omega + i\gamma</span>. Using the combination that arises from the commutator gives the two resonance denominators.</p>
<p>After performing the spatial Fourier transform (producing matrix elements <span class="math inline">(P_{i,\mathbf k})_{\ell m}</span> and <span class="math inline">(P_{j,-\mathbf k})_{m\ell}</span>) and the <span class="math inline">\tau</span>-integrals, and reorganizing the two terms from the commutator, you obtain</p>
</div>
<p><span class="math display">
\boxed{\;
\chi_{ij}(\mathbf k,\omega)
= \sum_{\ell,m} w_\ell\Big[
\frac{(P_{i,\mathbf k})_{\ell m}\,(P_{j,-\mathbf k})_{m\ell}}{\hbar\omega_{m\ell}-\hbar\omega - i\hbar\gamma}
\;+\;
\frac{(P_{j,-\mathbf k})_{\ell m}\,(P_{i,\mathbf k})_{m\ell}}{\hbar\omega_{m\ell}+\hbar\omega + i\hbar\gamma}
\Big],
\;}
</span></p>
<p>where <span class="math inline">\omega_{m\ell}=(E_m-E_\ell)/\hbar</span> and the infinitesimal <span class="math inline">\gamma\to0^+</span> implements the adiabatic switching (and gives the usual causal <span class="math inline">i0^+</span> prescription).</p>
<p>This is exactly the structure of equation (6.1.31): two contributions appear corresponding to absorption-like (denominator <span class="math inline">\hbar\omega_{m\ell}-\hbar\omega - i0^+</span>) and emission-like (denominator <span class="math inline">\hbar\omega_{m\ell}+\hbar\omega + i0^+</span>) processes, each weighted by the equilibrium population <span class="math inline">w_\ell</span> and the relevant transition matrix elements of the polarization operator in <span class="math inline">\mathbf k</span>-space.</p>
<hr>
<section id="remarks-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="remarks-interpretation">Remarks / interpretation</h2>
<ul>
<li>The first fraction resonates when <span class="math inline">\hbar\omega\approx\hbar\omega_{m\ell}=E_m-E_\ell</span> (absorption from <span class="math inline">\ell</span> to <span class="math inline">m</span>).</li>
<li>The second fraction resonates when <span class="math inline">\hbar\omega\approx -\hbar\omega_{m\ell}</span> (the opposite process).</li>
<li>The small positive <span class="math inline">\gamma</span> enforces causality (the Fourier transform of <span class="math inline">\Theta(\tau)</span> gives poles in the lower/upper half-plane consistent with retarded response).</li>
<li>If <span class="math inline">w_\ell</span> is thermal, you can combine terms using detailed-balance relations to express <span class="math inline">\chi</span> in alternative forms.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script src="../../scripts/leader-line-master/leader-line.min.js"></script>




</body></html>