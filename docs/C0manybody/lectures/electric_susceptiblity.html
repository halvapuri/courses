<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Electric Susceptibility â€“ Worldlines</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-343313b17078e6c2acf5a6c8a244e039.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1299936a809ae67bc7a7e26fb973ba17.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
function toggleBox(header) {
  // Use jQuery to find the associated container and toggle its visibility
  $(header).next('.dd-box').slideToggle();
  $(header).next('.ddm-box').slideToggle();
}
</script>

<script>
function togglePill(header) {
  const box = header.nextElementSibling;

  // toggle active pill state
  header.classList.toggle("active");

  // toggle content
  if (box.style.display === "block") {
    box.style.display = "none";
  } else {
    box.style.display = "block";
  }
}
</script>


<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".pill").forEach(pill => {
    const title = pill.getAttribute("title") || "";
    const bodyHtml = pill.innerHTML;

    // header
    const header = document.createElement("div");
    header.className = "pill-header";
    header.textContent = title;

    // body
    const body = document.createElement("div");
    body.className = "pill-body";
    body.innerHTML = bodyHtml;

    // reset pill
    pill.innerHTML = "";
    pill.appendChild(header);
    pill.appendChild(body);

    // toggle
    header.addEventListener("click", () => {
      header.classList.toggle("active");

      if (body.style.display === "block") {
        body.style.display = "none";
        pill.style.flexBasis = "auto";   // collapse back
      } else {
        body.style.display = "block";
        pill.style.flexBasis = "100%";   // expand pill to full row
      }
    });
  });
});
</script>


<script>
/**
 * Global registry and updater for all LeaderLine instances created via drawLeader.
 * Handles:
 *  - storing all lines
 *  - repositioning all lines on resize/scroll
 *  - smooth real-time repositioning during .pill transitions
 */
const LeaderLineRegistry = {
  lines: [],
  animating: false,
  _initialized: false,

  /**
   * Initialize one-time global event listeners for updating all registered lines.
   * This runs only once, automatically when the first line is registered.
   */
  init() {
    if (this._initialized) return;
    this._initialized = true;

    // Reposition all lines on window resize
    window.addEventListener('resize', () => this.positionAll());

    // Reposition all lines on scroll (capturing to catch scrolls on inner containers too)
    document.addEventListener('scroll', () => this.positionAll(), true);

    // Automatically add smooth animation loop for .pill transitions
    const pills = document.querySelectorAll('.pill');
    pills.forEach(pill => {
      pill.addEventListener('click', () => {
        if (this.animating) return;
        this.animating = true;

        const step = () => {
          this.positionAll();
          if (this.animating) requestAnimationFrame(step);
        };
        requestAnimationFrame(step);
      });

      pill.addEventListener('transitionend', () => {
        this.animating = false;
        this.positionAll();
      });
    });
  },

  /**
   * Register a newly created LeaderLine instance so it is tracked and updated.
   * @param {LeaderLine} line - The LeaderLine object to register
   */
  register(line) {
    this.init();
    this.lines.push(line);
  },

  /**
   * Calls .position() on every registered line to recalculate its endpoints.
   */
  positionAll() {
    this.lines.forEach(line => line.position());
  }
};

/**
 * Creates two DOM anchor elements (if not already present) inside a container
 * and draws a LeaderLine between them. Automatically registers the line
 * into the global LeaderLineRegistry so it stays in sync with layout changes.
 *
 * @param {Object} config
 * @param {string} [config.containerId='stage'] - The id of the container element
 * @param {Object} config.from - The "from" anchor element config
 * @param {string} config.from.id - DOM id of the starting element
 * @param {string} [config.from.text] - Optional text content for the element
 * @param {string} [config.from.className] - Optional CSS class
 * @param {Object} [config.from.style] - Inline style object
 * @param {Object} config.to - The "to" anchor element config (same fields as 'from')
 * @param {Object} [config.lineOptions={}] - Options passed directly to new LeaderLine()
 *
 * @returns {Promise<LeaderLine>} Resolves with the created LeaderLine instance
 */
function drawLeader(config) {
  const { containerId='stage', from, to, lineOptions={} } = config;

  return new Promise(resolve => {
    window.addEventListener('load', () => {
      const container = document.getElementById(containerId);
      const elements = { from, to };
      const createdDivs = {};

      for (const key in elements) {
        const { id, text, className, style } = elements[key];
        let el = document.getElementById(id);

        if (!el || !container.contains(el)) {
          el = document.createElement('div');
          el.id = id;
          el.textContent = text || '';
          el.className = className || 'anchor80-line';
          Object.assign(el.style, { position: 'relative', ...style });
          container.appendChild(el);
        }

        createdDivs[key] = el;
      }

      const line = new LeaderLine(createdDivs.from, createdDivs.to, lineOptions);
      LeaderLineRegistry.register(line);
//      resolve(line);
      return line;
    });
  });
}

</script>






  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../css/buttons.css">
<link rel="stylesheet" href="../../css/tabs.css">
<link rel="stylesheet" href="../../css/callouts.css">
<link rel="stylesheet" href="../../css/fonts-ebgaramond.css">
<link rel="stylesheet" href="../../css/fonts-hand.css">
<link rel="stylesheet" href="../../css/shapes.css">
<link rel="stylesheet" href="../../css/leaders.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Worldlines</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Courses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses">    
        <li>
    <a class="dropdown-item" href="../../C0calculusI/home_calculusI.html">
 <span class="dropdown-text">Calculus I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../C0calculusII/home_calculusII.html">
 <span class="dropdown-text">Calculus II</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../C0ode/home_ode.html">
 <span class="dropdown-text">Diff. Eqs. &amp; Lin. Alg.</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../C0noneqthermo/home_noneqthermo.html">
 <span class="dropdown-text">Non-equilibrium Thermodynamics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-guides" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Guides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-guides">    
        <li>
    <a class="dropdown-item" href="../../D0abinit/home_abinit.html">
 <span class="dropdown-text">Ab initio calculation</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../C0manybody/lectures/currentdensityoperator.html">Topics</a></li><li class="breadcrumb-item"><a href="../../C0manybody/lectures/electric_susceptiblity.html">Electric Susceptibility</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../_figs/hugorheinholdchimp.png" alt="Undergraduate ponders mysteries of physics, mathematics, and life" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/home_manybody.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Many-Body Physics Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/currentdensityoperator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Current Density Operator and Polarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/electric_susceptiblity.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Electric Susceptibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/exchangecorrelation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exchange &amp; Correlation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/excitons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Excitons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/greensfunctions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Greenâ€™s Functions in Many-Body Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/homogeneouselectrongas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HEG/jellium</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kohnsham.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kohn Sham Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kramerskronig.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyticity, Causality, and Kramers-Kronig Relations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kubofigure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kubofigure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/kuboformula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kubo formula and response functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/linearresponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linearresponse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/phonons_optic_acoustic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acoustic vs Optical Phonons</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../C0manybody/lectures/quasiparticles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quasiparticles and Fermi Liquid Theory</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#susceptibility-links-polarization-and-electric-field-greenly" id="toc-susceptibility-links-polarization-and-electric-field-greenly" class="nav-link active" data-scroll-target="#susceptibility-links-polarization-and-electric-field-greenly">Susceptibility links Polarization and Electric Field Greenly:</a></li>
  <li><a href="#but-how-to-express-susceptibility" id="toc-but-how-to-express-susceptibility" class="nav-link" data-scroll-target="#but-how-to-express-susceptibility">But how to express susceptibility?</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../C0manybody/lectures/currentdensityoperator.html">Topics</a></li><li class="breadcrumb-item"><a href="../../C0manybody/lectures/electric_susceptiblity.html">Electric Susceptibility</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Electric Susceptibility</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Much of what follows is an elboration of <em>Toyozawa, Optical Processes in Solids, Chapter 6</em></p>
</div>
</div>
</div>
<p>Since we are going to apply time-dependent perturbations in the linear response regime, we need to remind ourselves, how the values of an observable vary when the perturbation comes into play. That is to say we need to remind ourselves of the Kubo formula.</p>
<div class="pillset">
<div class="pill" title="Kubo Formula">
<p><a href="https://en.wikipedia.org/wiki/Kubo_formula">Derivation of Kubo formula</a></p>
<p><span class="math display">
{\displaystyle \langle {\hat {A}}(t)\rangle =\left\langle {\hat {A}}\right\rangle _{0}-{\frac {i}{\hbar }}\int _{t_{0}}^{t}dt'\left\langle \left[{\hat {A}}(t),{\hat {V}}{\mathord {\left(t'\right)}}\right]\right\rangle _{0}}
</span></p>
<p>And thus in linear response theory, the change in expectation value of an operator <span class="math inline">\hat A</span> is <span id="eq-kubo"><span class="math display">
\delta\langle \hat A(t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^t dt' \,
\langle [\hat H_I(t'), \hat A(t)] \rangle_0 ,
\tag{1}</span></span></p>
<p>with <span class="math inline">\hat H_I(t')</span> the interaction Hamiltonian.</p>
</div>
<div class="pill" title="...applied to polarization and E-field">
<p>In our case we have a perturbation due to the interaction between electric polarization and the electric field.</p>
<p><span id="eq-hamiltonian"><span class="math display">
\hat H(t) = H_0 - \int d\mathbf r'\,\hat{\mathbf P}(\mathbf r') \cdot \mathbf E(\mathbf r',t),
\tag{2}</span></span></p>
<p>where <span class="math inline">\hat{\mathbf P}(\mathbf r)</span> is the polarization operator.</p>
<p>For <span class="math inline">\hat A(t) = \hat P_i(\mathbf r,t)</span>,<span class="math inline">\ </span> <a href="#eq-kubo" class="quarto-xref">Equation&nbsp;1</a> becomes: <span class="math display">
\delta \langle \hat P_i(\mathbf r,t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^t dt' \int d\mathbf r' \,
\Big\langle \big[ -\hat P_j(\mathbf r',t') E_j(\mathbf r',t'), \,
\hat P_i(\mathbf r,t) \big] \Big\rangle_0 .
</span></p>
<p>Since <span class="math inline">E_j(\mathbf r',t')</span> is a classical field (a c-number, not an operator), it commutes with operators and can be pulled out: <span class="math display">
= -\frac{i}{\hbar}\int_{-\infty}^t dt' \int d\mathbf r' \,
E_j(\mathbf r',t') \, \langle [\hat P_j(\mathbf r',t'), \hat P_i(\mathbf r,t)] \rangle_0 .
</span></p>
<p>Using <span class="math inline">[X,Y] = -[Y,X]</span>, this becomes <span class="math display">
\delta \langle \hat P_i(\mathbf r,t)\rangle
= \frac{i}{\hbar}\int_{-\infty}^t dt' \int d\mathbf r' \,
\langle [\hat P_i(\mathbf r,t), \hat P_j(\mathbf r',t')] \rangle_0 \,
E_j(\mathbf r',t') .
</span></p>
</div>
<div class="pill" title="to bring in retarded susceptibility as a Green's function">
<p>We can now introduce the retarded susceptibility (response function): <span class="math display">
\chi_{ij}^R(\mathbf r,t;\mathbf r',t')
= \frac{i}{\hbar} \, \Theta(t-t') \,
\langle [\hat P_i(\mathbf r,t), \hat P_j(\mathbf r',t')] \rangle_0 .
</span></p>
<p>Then the response takes the compact Greenâ€™s-function form: <span class="math display">
\delta \langle \hat P_i(\mathbf r,t)\rangle
= \int d\mathbf r' \int_{-\infty}^\infty dt' \,
\chi_{ij}^R(\mathbf r,t;\mathbf r',t') \, E_j(\mathbf r',t').
</span></p>
</div>
</div>
<hr>
<section id="susceptibility-links-polarization-and-electric-field-greenly" class="level2">
<h2 class="anchored" data-anchor-id="susceptibility-links-polarization-and-electric-field-greenly">Susceptibility links Polarization and Electric Field Greenly:</h2>
<p>So susceptibility is really a Greenâ€™s function and when a weak external electric field <span class="math inline">\mathbf E(\mathbf r,t)</span> is applied, the system responds linearly with an induced polarization <span class="math inline">\mathbf P(\mathbf r,t)</span>. In the <strong>linear response regime</strong>, the most general linear relation between cause (field) and effect (polarization) is</p>
<p><span id="eq-polarization"><span class="math display">
P_i(\mathbf r,t) = \int d\mathbf r' \int_{-\infty}^\infty dt' \,
\chi_{ij}(\mathbf r,t;\mathbf r',t') \, E_j(\mathbf r',t').
\tag{3}</span></span></p>
<p>Here <span class="math inline">\chi</span> is the <strong>susceptibility tensor</strong>, has certain properties by default or by imposition:</p>
<div class="pillset">
<div class="pill" title="Linearity &amp; Superposition">
<p>Because the system is weakly perturbed, the polarization is a linear functional of the applied field.</p>
</div>
<div class="pill" title="Nonlocality in Space and Time">
<p>A perturbation at <span class="math inline">(\mathbf r',t')</span> can influence the polarization at <span class="math inline">(\mathbf r,t)</span>. This makes <span class="math inline">\chi</span> depend on two spacetime points.</p>
</div>
<div class="pill" title="Causality">
<p>A result cannot precede its cause. Therefore, <span class="math display">
\chi_{ij}(\mathbf r,t;\mathbf r',t') = 0 \quad \text{for } t &lt; t' .
</span></p>
</div>
</div>
<hr>
</section>
<section id="but-how-to-express-susceptibility" class="level2">
<h2 class="anchored" data-anchor-id="but-how-to-express-susceptibility">But how to express susceptibility?</h2>
<p>To find an expression for suceptibility, we need the following steps:</p>
<ul>
<li>Use the interaction hamiltonian to find the perturbed wavefunction.</li>
<li>Find the elements of the polarization operator.</li>
<li>Exploit the relationship between the current density and polarization operator.</li>
<li>Take the statistical average on initial states to find the susceptibility.</li>
</ul>
<p>For brownie points we then try to find frequency domain alternatives too.</p>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" role="list">

</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script src="../../scripts/leader-line-master/leader-line.min.js"></script>




</body></html>